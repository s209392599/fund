<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <form id="myForm">
    <input type="text" name="username" value="John" />
    <input type="text" name="username" value="boxue" />
    <input type="text" name="age" value="25" />
  </form>
  <script>
    const form = document.getElementById("myForm");
    const formData = new FormData(form);
    console.log(formData);
    console.log(new URLSearchParams(formData).size);
    console.log(new URLSearchParams(formData).get('username'));
    console.log(new URLSearchParams(formData).getAll('username'));

    // 获取所有键（name）
    console.log(Array.from(new URLSearchParams(formData).keys())); // ["username", "username", "age"]

    // 获取所有值（value）
    console.log(Array.from(new URLSearchParams(formData).values())); // ["John", "boxue", "25"]

    // 获取键值对（[name, value] 数组）
    console.log(Array.from(new URLSearchParams(formData).entries()));
    // 输出: [ ["username", "John"], ["username", "boxue"], ["age", "25"] ]

    const queryString = new URLSearchParams(formData).toString();
    console.log(queryString);


    class DataCache {
      constructor() {
        this.cache = new WeakMap();
      }

      get(key) {
        return this.cache.get(key)?.deref();
      }

      set(key, value) {
        this.cache.set(key, new WeakRef(value));
      }
    }

    // 使用示例
    const cache = new DataCache();
    const largeObject = { /* 一些大数据 */ };
    cache.set('largeObject', largeObject);

    // 在某个时间点后，largeObject 不再被其他地方引用
    // 垃圾回收器将回收 largeObject，同时 WeakRef 也会失效
    const cachedObject = cache.get('largeObject');
    if (cachedObject) {
      console.log('Object retrieved from cache:', cachedObject);
    } else {
      console.log('Object not found in cache (possibly garbage collected).');
    }
  </script>
</body>

</html>